<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- font awesome -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
        <!-- fonts -->
        <link rel="stylesheet" href="https://use.typekit.net/qwy7dph.css">
        <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,600,700,900&display=swap" rel="stylesheet">
        <!-- css -->
        <link rel="stylesheet" href="/static/research_css/research.css">
        <title>Pravega Ventures</title>
    </head>
<body>
   <header>
        <div class="head-wrap clearfix">
            <p>Pravega <span>Ventures</span></p>
            <div class="profile-div" onclick="nav_drop()">
                <!-- <img src="pro-pic.jpg"> -->
                <img src="/static/contacts_css/Pushpak Kedia.jpg">
                <div class="nav-drop" id="nav_drop">

                    <p class="name">{{request.user.first_name}} {{request.user.last_name}}</p>
                    <p class="designation">UI/UX Developer</p>
                    <a href="/logout/">
                    <p class="nav-list">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M10.09 15.59L11.5 17L16.5 12L11.5 7L10.09 8.41L12.67 11H3V13H12.67L10.09 15.59ZM19 3H5C3.89 3 3 3.9 3 5V9H5V5H19V19H5V15H3V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3Z" fill="black"/>
                            </svg>

                        Log Out

                    </p></a>


                </div>
            </div>


            </div>
        </div>
    </header>
    <main>
        <article>
            <section class="header2">
                <div class="text-wrap">
                    <p class="heading">PRAVEGA RESEARCH</p>
                    <P class="discription">A collection of our research notes in different Industries</P>
                </div>
            </section>
            <section class="content-wrap"> 
                <div class="filter-wrap clearfix">
                    <div class="filters clearfix">
                        <p class="filter-text">Filter : </p>
                        <div class="btn-group">
                            <button id="All" type="button" class="category">All</button>
                            {% for category in categories %}
                            <button id="{{ category.category }}" class="category" type="button">{{ category.category  }}</button>
                            {% endfor %}
<!--                            <button type="button">Fintech</button>-->
<!--                            <button type="button">Enterprise</button>-->
                        </div>
                    </div>
                    <div class="search">
<!--                        {% if search_key == None %}-->
                            <input type="search" name="search_research_note" id="search_research_note" placeholder="Search" value="">
<!--                        {% else %}-->
<!--                            <input type="search" name="search_research_note" id="search_research_note" placeholder="Search" value="{{ search_key }}">-->
<!--                        {% endif %}-->
                    </div>
                </div>
                <div class="table-data">
                    <table>
                        <thead>
                            <tr>
                                <th>Sector</th>
                                <th>Sub-Sector</th>
                                <th>Title</th>
                                <th>Date Published</th>
                                <th class="td-btn">Download Button</th>
                            </tr>
                        </thead>
                        <tbody id="re">
                        {% for research_note in research_notes %}
                            <tr>
                                <td>
                                    <p id="sector">{{ research_note.category }}</p>
                                </td>
                                <td>
                                    <p id="subsector">{{ research_note.sub_sector }}</p>
                                </td>
                                <td>
                                    <p><a href="/researchdetail/{{ research_note.id }}/">{{ research_note.title }}</a></p>
                                </td>
                                <td>
                                    <p>{{ research_note.date_published }}</p>
                                </td>
                                <td class="td-btn">
                                    <a href="https://pravega-contactimages-ap-south-1.s3.amazonaws.com/media/{{ research_note.file_url }}" target="_blank" download>
                                        <button>
<!--                                    <button type="button" windows.location.href="https://pravega-contactimages-ap-south-1.s3.amazonaws.com/{{ research_note.file_url }}">-->
                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>
                                        </svg>
                                            </button>
                                        </a>

                                </td>
                            </tr>
                        {% endfor %}
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <p>Consumer</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Ed-Tech</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p><a href="">Leading as a service - platform as a change</a></p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Feb 20, 2020</p>-->
<!--                                </td>-->
<!--                                <td class="td-btn">-->
<!--                                    <button type="button">-->
<!--                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>-->
<!--                                        </svg>-->
<!--                                    </button>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <p>Consumer</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Ed-Tech</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p><a href="">Leading as a service - platform as a change</a></p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Feb 20, 2020</p>-->
<!--                                </td>-->
<!--                                <td class="td-btn">-->
<!--                                    <button type="button">-->
<!--                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>-->
<!--                                        </svg>-->
<!--                                    </button>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <p>Consumer</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Ed-Tech</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p><a href="">Leading as a service - platform as a change</a></p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Feb 20, 2020</p>-->
<!--                                </td>-->
<!--                                <td class="td-btn">-->
<!--                                    <button type="button">-->
<!--                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>-->
<!--                                        </svg>-->
<!--                                    </button>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <p>Consumer</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Ed-Tech</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p><a href="">'Leading as a service - platform as a change'</a></p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Feb 20, 2020</p>-->
<!--                                </td>-->
<!--                                <td class="td-btn">-->
<!--                                    <button type="button">-->
<!--                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>-->
<!--                                        </svg>-->
<!--                                    </button>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <p>Consumer</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Ed-Tech</p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p><a href="">Leading as a service - platform as a change</a></p>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <p>Feb 20, 2020</p>-->
<!--                                </td>-->
<!--                                <td class="td-btn">-->
<!--                                    <button type="button">-->
<!--                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>-->
<!--                                        </svg>-->
<!--                                    </button>-->
<!--                                </td>-->
<!--                            </tr>-->

                        </tbody>
                    </table>
                </div>


                <div class="pagination-wrap">
                    {% if research_notes.has_other_pages %}
                    <div class="btn-grp">
                        {% if research_notes.has_previous %}
<!--                            <button><i class="fas fa-caret-left"><a style="text-decoration:none" href="/research_note_category/?page={{ research_notes.previous_page_number }}">&laquo;</a></i></button>-->
                             <button id="{{ research_notes.previous_page_number }}" class="paginate previous"><i class="fas fa-caret-left"></i></button>
                         {% else %}
<!--                            <button class="disable"><span>&laquo;</span></button>-->
                                <button class="disable previous"><i class="fas fa-caret-left"></i></button>
                        {% endif %}
                        {% for i in research_notes.paginator.page_range %}
                        {% if research_notes.number == i %}
                            <button id="{{ i }}" class="active paginate pg previous"><span>{{ i }} <span class="sr-only">(current)</span></span></button>
                        {% else %}
<!--                            <button><a href="?page={{ i }}">{{ i }}</a></button>-->
                                <button id="{{ i }}" class="paginate previous">{{ i }}</button>
                         {% endif %}
                         {% endfor %}
<!--                        <button>2</button>-->
<!--                        <button>3</button>-->
<!--                        <button>4</button>-->
<!--                        <button>5</button>-->
                        {% if research_notes.has_next %}
<!--                            <button><i class="fas fa-caret-right"><a style="text-decoration:none" href="/research_note_category/?page={{ research_notes.next_page_number }}">&raquo;</a></i></button>-->
                                <button id="{{ research_notes.next_page_number }}" class="paginate previous"><i class="fas fa-caret-right"></i></button>
                        {% else %}
<!--                            <button class=""><span>&raquo;</span></button>-->
                                <button class="disable previous"><i class="fas fa-caret-left"></i></button>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>

            </section>
        </article>
    </main>
 <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
<script>
 $( document ).ready(function() {
    $('#All').addClass("active");
});
 $('.category').click(function(){

       $('.category').removeClass("active");
       $(this).addClass("active");
       console.log("add");
       load_page( $(this).attr("id"),1,$('[name=search_research_note]').val())

     });

$('body').delegate(".paginate", "click", function(){

<!--       $('.category').removeClass("active");-->
<!--       $(this).addClass("active");-->
       console.log("add");
load_page( $(".active").attr("id"),$(this).attr("id"),$('[name=search_research_note]').val())
   });






function load_page(ppid,page,search)
{
     $.ajax({
            method: "GET",
            url: "/research_note_category/",
            data: { 'page':  page,'ppid':  ppid,'search':search},
            success: function(data)
            {
            console.log(data['research_notes_info']);
            var data_to_parse=data["research_notes_info"]
            var data1 = data['research_notes_info'];
            console.log(data1.length);
            document.getElementById("re").innerHTML="";
            for(i=0;i<data1.length;i++)
                {
                console.log(data1[i].category)

                 var res='<tr><td><p id="sector">'+data1[i].category+'</p></td><td><p id="subsector">'+data1[i].sub_sector+'</p></td>'+
                 '<td><p><a href="/researchdetail/'+data1[i].id+'/">'+data1[i].title+'</a></p></td><td> <p>'+data1[i].date_published+'</p></td>'+
                  '<td class="td-btn"> <a href="'+data1[i].file_url+'" target="_blank">'+
                  '<button type="button"><svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">'+
                  '<path fill-rule="evenodd" clip-rule="evenodd" d="M15.0413 7.125H11.8747V2.375H7.12467V7.125H3.95801L9.49967 12.6667L15.0413 7.125ZM3.95801 14.25V15.8333H15.0413V14.25H3.95801Z" fill="white"/>'+
                   '</svg> </button></a></td></tr>'
                document.getElementById("re").innerHTML+=res;

                }
                if(data["search_key"]!="None")
                {
                 console.log(data["search_key"])
                  $('#search_research_note').attr('value',data["search_key"])
                }
                else
                {
                console.log("search")
                console.log(data["search_key"])
                $('#search_research_note').attr('value','kjlk')
                }


                $(".previous").remove();
             if(data["other_pages"]=='True')
                {
                if(data["previous_page"]!="none")
                    {
                        console.log(data["previous_page"])
                         $(".btn-grp").append('<button id="'+data["previous_page"]+'" class="paginate previous"><i class="fas fa-caret-left"></i></button>')
<!--                        $('.paginate').attr('id',data["previous_page"])-->

<!--                        console.log(data["num_pages"])-->
                    }
                    else
                    {
                    $(".btn-grp").append('<button class="disable previous"><i class="fas fa-caret-left"></i></button>')
<!--                        $('.paginate').attr('id',data["previous_page"])-->

<!--                        console.log(data["num_pages"])-->
                    }
                  for(var i=1;i<=data["num_pages"];i++)
                    {
                        if(data["number"]==i)
                        {
                            $(".btn-grp").append('<button id="'+i+'" class="active paginate pg previous"><span>'+i+' <span class="sr-only">(current)</span></span></button>')
                        }
                        else
                        {
                            $(".btn-grp").append('<button id="'+i+'" class="paginate previous">'+i+'</button>')
                        }

                    }
                    if(data["next_page"]!="none")
                    {
                          $(".btn-grp").append('<button id="'+data["next_page"]+'" class="paginate previous"><i class="fas fa-caret-right"></i></button>')
<!--                        $('.paginate').attr('id',data["previous_page"])-->

                        console.log(data["num_pages"])
                    }
                    else
                    {
                   $(".btn-grp").append(' <button class="disable previous"><i class="fas fa-caret-right"></i></button>')
<!--                        $('.paginate').attr('id',data["previous_page"])-->

                        console.log(data["num_pages"])
                    }
                 }










            }
            })

 }




function search() {
<!--            window.location.href = document.location.origin+'/researchnote?search='+$('[name=search_research_note]').val();-->
var search=$('[name=search_research_note]').val();
console.log($('[name=search_research_note]').val())
console.log($(".active").attr("id"))
console.log($(".pg").attr("id"))
load_page($(".active").attr("id"),1,search)

            }
$('#search_research_note').keypress(function (e) {
             var key = e.which;
             if(key == 13)  // the enter key code
              {
                search();
              }
        });
        document.getElementById("nav_drop").style.display = "none";
        function nav_drop() {
            var nav = document.getElementById("nav_drop");
            console.log(nav.style.display);
            if (nav.style.display === "none") {
                console.log("if none");
                nav.style.display = "block";
            } else {
                nav.style.display = "none";
                console.log("else");
            }
            }
</script>
</body>
</html>